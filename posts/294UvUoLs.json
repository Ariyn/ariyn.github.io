{"ParentUid":"294UvUoLs","Uid":"294UvUoLs","Data":"file write가 안되는 경우 #개발 #golang #linux #TIL","Order":0,"IsRoot":true,"Children":[{"ParentUid":"294UvUoLs","Uid":"EGdJYYLKD","Data":"문제의 코드","Order":0,"IsRoot":false,"Children":[{"ParentUid":"EGdJYYLKD","Uid":"j6iq64npi","Data":"```javascript\nf, err := os.OpenFile(\"/tmp/test\", os.Append, 0755)\nif err != nil {\n  panic(err)\n}\n\nfmt.Fprintln(f, \"test\")```","Order":0,"IsRoot":false,"Children":[],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"}],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"},{"ParentUid":"294UvUoLs","Uid":"322lv3ZBK","Data":"그러나 쓰기가 되지 않았고, fmt.Fprintln의 err을 확인했을때 아래의 오류가 나왔다.","Order":1,"IsRoot":false,"Children":[{"ParentUid":"322lv3ZBK","Uid":"9NvrWNqUx","Data":"`bad file descriptor`","Order":0,"IsRoot":false,"Children":[],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"}],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"},{"ParentUid":"294UvUoLs","Uid":"iYrnLDXmv","Data":"확인해본 결과, O_APPEND는 우리의 생각과 다르게 access mode가 아니라고 한다.","Order":2,"IsRoot":false,"Children":[{"ParentUid":"iYrnLDXmv","Uid":"YRBsNbNsw","Data":"`The argument __flags__ must include one of the following __access modes__: **O_RDONLY**, **O_WRONLY**, or **O_RDWR**.  These request opening the file read-only, write-only, or read/write, respectively.`","Order":0,"IsRoot":false,"Children":[{"ParentUid":"YRBsNbNsw","Uid":"wQ6TdVKFx","Data":"https://man7.org/linux/man-pages/man2/open.2.html","Order":0,"IsRoot":false,"Children":[],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"}],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"},{"ParentUid":"iYrnLDXmv","Uid":"dR5TciPpS","Data":"open 커맨드의 man에 따르자면, access mode는 세가지. **O_RDONLY**, **O_WRONLY**, **O_RDWR**인 듯 하다.","Order":1,"IsRoot":false,"Children":[{"ParentUid":"dR5TciPpS","Uid":"ByDxBb3HB","Data":"이 세개중 하나는 반드시 들어가야 한다.","Order":0,"IsRoot":false,"Children":[],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"}],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"}],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"},{"ParentUid":"294UvUoLs","Uid":"iFm8msc-J","Data":"각각의 플래그의 값은 이렇다.","Order":3,"IsRoot":false,"Children":[{"ParentUid":"iFm8msc-J","Uid":"ihfNAvqYc","Data":"```javascript\nO_RDONLY                          = 0x0\nO_WRONLY                          = 0x1\nO_RDWR                            = 0x2\nO_APPEND                          = 0x8```","Order":0,"IsRoot":false,"Children":[],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"},{"ParentUid":"iFm8msc-J","Uid":"3TsBVAGVb","Data":"따라서 O_APPEND만 사용하면 `0x8`이 되는데, 첫번째 비트가 0이기 때문에, `O_RDONLY`로 열리게 되는 것.","Order":1,"IsRoot":false,"Children":[],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"}],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"},{"ParentUid":"294UvUoLs","Uid":"-K5MMM-C2","Data":"추가로 golang에서 파일을 열 때 사용할 수 있는 플래그는 아래와 같다.","Order":4,"IsRoot":false,"Children":[{"ParentUid":"-K5MMM-C2","Uid":"qxxVuGTOQ","Data":"```javascript\ngolang/src/os/file.go\nconst (\n\t// Exactly one of O_RDONLY, O_WRONLY, or O_RDWR must be specified.\n\tO_RDONLY int = syscall.O_RDONLY // open the file read-only.\n\tO_WRONLY int = syscall.O_WRONLY // open the file write-only.\n\tO_RDWR   int = syscall.O_RDWR   // open the file read-write.\n\t// The remaining values may be or'ed in to control behavior.\n\tO_APPEND int = syscall.O_APPEND // append data to the file when writing.\n\tO_CREATE int = syscall.O_CREAT  // create a new file if none exists.\n\tO_EXCL   int = syscall.O_EXCL   // used with O_CREATE, file must not exist.\n\tO_SYNC   int = syscall.O_SYNC   // open for synchronous I/O.\n\tO_TRUNC  int = syscall.O_TRUNC  // truncate regular writable file when opened.\n)```","Order":0,"IsRoot":false,"Children":[],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"},{"ParentUid":"-K5MMM-C2","Uid":"jdU7nYw3q","Data":"확인해보니 주석으로도 세개중 하나를 반드시 사용하라고 되어 있다...","Order":1,"IsRoot":false,"Children":[],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"}],"Images":null,"CreateTime":"1970-01-01T09:00:00+09:00","EditTime":"1970-01-01T09:00:00+09:00"}],"Images":[],"CreateTime":"2021-12-09T17:51:08+09:00","EditTime":"1970-01-01T09:00:00+09:00"}